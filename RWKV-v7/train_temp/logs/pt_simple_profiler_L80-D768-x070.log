INFO:pytorch_lightning.profilers.profiler:FIT Profiler Report

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                               |  Mean duration (s)    |  Num calls            |  Total time (s)       |  Percentage %         |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                |  -                    |  37007                |  902.16               |  100 %                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                   |  879.54               |  1                    |  879.54               |  97.492               |
|  run_training_batch                                                   |  1.0326               |  840                  |  867.4                |  96.147               |
|  [LightningModule]RWKV_shared.optimizer_step                          |  1.0284               |  840                  |  863.83               |  95.751               |
|  [Strategy]DeepSpeedStrategy.backward                                 |  0.74901              |  840                  |  629.16               |  69.74                |
|  [Strategy]DeepSpeedStrategy.training_step                            |  0.25165              |  840                  |  211.39               |  23.431               |
|  [Callback]train_callback.on_train_batch_end                          |  0.0043438            |  840                  |  3.6488               |  0.40445              |
|  [Callback]TQDMProgressBar.on_train_batch_end                         |  0.002895             |  840                  |  2.4318               |  0.26955              |
|  [Callback]train_callback.on_train_batch_start                        |  0.0027052            |  840                  |  2.2723               |  0.25188              |
|  [TrainingEpochLoop].train_dataloader_next                            |  0.0025342            |  840                  |  2.1287               |  0.23596              |
|  [LightningModule]RWKV_shared.training_step_end                       |  0.00075411           |  840                  |  0.63345              |  0.070215             |
|  [Callback]train_callback.on_train_epoch_end                          |  0.4767               |  1                    |  0.4767               |  0.052839             |
|  [LightningModule]RWKV_shared.configure_optimizers                    |  0.42278              |  1                    |  0.42278              |  0.046863             |
|  [Strategy]DeepSpeedStrategy.batch_to_device                          |  0.00048639           |  840                  |  0.40857              |  0.045288             |
|  [LightningModule]RWKV_shared.transfer_batch_to_device                |  0.00034408           |  840                  |  0.28902              |  0.032037             |
|  [LightningModule]RWKV_shared.configure_gradient_clipping             |  7.5461e-05           |  840                  |  0.063387             |  0.0070261            |
|  [LightningModule]RWKV_shared.optimizer_zero_grad                     |  7.4605e-05           |  840                  |  0.062668             |  0.0069465            |
|  [Callback]train_callback.on_after_backward                           |  1.443e-05            |  840                  |  0.012121             |  0.0013435            |
|  [Callback]ModelSummary.on_train_batch_end                            |  1.0356e-05           |  840                  |  0.0086994            |  0.00096428           |
|  [Callback]train_callback.on_before_optimizer_step                    |  6.1195e-06           |  840                  |  0.0051404            |  0.00056978           |
|  [Callback]TQDMProgressBar.on_train_batch_start                       |  4.8541e-06           |  840                  |  0.0040775            |  0.00045197           |
|  [Callback]TQDMProgressBar.on_after_backward                          |  4.5174e-06           |  840                  |  0.0037946            |  0.00042061           |
|  [LightningModule]RWKV_shared.on_after_backward                       |  4.4977e-06           |  840                  |  0.0037781            |  0.00041878           |
|  [LightningModule]RWKV_shared.on_before_batch_transfer                |  4.1334e-06           |  840                  |  0.0034721            |  0.00038486           |
|  [Callback]ModelSummary.on_fit_start                                  |  0.0033032            |  1                    |  0.0033032            |  0.00036615           |
|  [Callback]GradientAccumulationScheduler.on_train_batch_end           |  3.6586e-06           |  840                  |  0.0030732            |  0.00034065           |
|  [LightningModule]RWKV_shared.on_train_batch_end                      |  3.4322e-06           |  840                  |  0.002883             |  0.00031957           |
|  [Callback]TQDMProgressBar.on_before_optimizer_step                   |  3.4026e-06           |  840                  |  0.0028582            |  0.00031682           |
|  [Callback]GradientAccumulationScheduler.on_after_backward            |  3.2667e-06           |  840                  |  0.002744             |  0.00030416           |
|  [Callback]train_callback.on_before_zero_grad                         |  3.2567e-06           |  840                  |  0.0027356            |  0.00030323           |
|  [Callback]ModelSummary.on_after_backward                             |  3.0856e-06           |  840                  |  0.0025919            |  0.0002873            |
|  [Callback]ModelSummary.on_before_optimizer_step                      |  3.0823e-06           |  840                  |  0.0025891            |  0.00028699           |
|  [Callback]GradientAccumulationScheduler.on_before_optimizer_step     |  3.0263e-06           |  840                  |  0.0025421            |  0.00028177           |
|  [Callback]ModelSummary.on_train_batch_start                          |  2.8169e-06           |  840                  |  0.0023662            |  0.00026228           |
|  [LightningModule]RWKV_shared.on_train_batch_start                    |  2.7921e-06           |  840                  |  0.0023453            |  0.00025997           |
|  [LightningModule]RWKV_shared.on_before_optimizer_step                |  2.7433e-06           |  840                  |  0.0023044            |  0.00025543           |
|  [LightningModule]RWKV_shared.on_after_batch_transfer                 |  2.7021e-06           |  840                  |  0.0022698            |  0.00025159           |
|  [Strategy]DeepSpeedStrategy.on_train_batch_start                     |  2.6236e-06           |  840                  |  0.0022038            |  0.00024428           |
|  [Callback]GradientAccumulationScheduler.on_train_batch_start         |  2.4999e-06           |  840                  |  0.0020999            |  0.00023276           |
|  [Strategy]DeepSpeedStrategy.training_step_end                        |  2.267e-06            |  840                  |  0.0019043            |  0.00021108           |
|  [Callback]train_callback.on_before_backward                          |  1.9701e-06           |  840                  |  0.0016549            |  0.00018344           |
|  [LightningModule]RWKV_shared.on_before_zero_grad                     |  1.8672e-06           |  840                  |  0.0015684            |  0.00017385           |
|  [Callback]TQDMProgressBar.on_before_zero_grad                        |  1.4608e-06           |  840                  |  0.0012271            |  0.00013602           |
|  [LightningModule]RWKV_shared.on_before_backward                      |  1.2874e-06           |  840                  |  0.0010814            |  0.00011987           |
|  [Callback]ModelSummary.on_before_zero_grad                           |  1.1656e-06           |  840                  |  0.00097906           |  0.00010852           |
|  [Callback]TQDMProgressBar.on_train_epoch_end                         |  0.00097794           |  1                    |  0.00097794           |  0.0001084            |
|  [Callback]TQDMProgressBar.on_train_start                             |  0.00097202           |  1                    |  0.00097202           |  0.00010774           |
|  [Callback]GradientAccumulationScheduler.on_before_zero_grad          |  1.131e-06            |  840                  |  0.00095003           |  0.00010531           |
|  [Callback]TQDMProgressBar.on_before_backward                         |  1.1074e-06           |  840                  |  0.00093023           |  0.00010311           |
|  [Callback]ModelSummary.on_before_backward                            |  1.0574e-06           |  840                  |  0.00088819           |  9.8451e-05           |
|  [Callback]GradientAccumulationScheduler.on_before_backward           |  9.9545e-07           |  840                  |  0.00083617           |  9.2686e-05           |
|  [Callback]TQDMProgressBar.on_train_end                               |  0.00043928           |  1                    |  0.00043928           |  4.8691e-05           |
|  [Callback]TQDMProgressBar.on_train_epoch_start                       |  0.00026339           |  1                    |  0.00026339           |  2.9196e-05           |
|  [Callback]train_callback.setup                                       |  4.1855e-05           |  1                    |  4.1855e-05           |  4.6395e-06           |
|  [Callback]TQDMProgressBar.setup                                      |  3.0909e-05           |  1                    |  3.0909e-05           |  3.4261e-06           |
|  [Callback]train_callback.on_train_epoch_start                        |  2.406e-05            |  1                    |  2.406e-05            |  2.6669e-06           |
|  [Callback]train_callback.on_fit_end                                  |  1.5937e-05           |  1                    |  1.5937e-05           |  1.7665e-06           |
|  [Callback]ModelSummary.on_train_epoch_end                            |  9.9186e-06           |  1                    |  9.9186e-06           |  1.0994e-06           |
|  [Callback]train_callback.on_train_end                                |  7.9963e-06           |  1                    |  7.9963e-06           |  8.8635e-07           |
|  [Callback]train_callback.on_fit_start                                |  6.8769e-06           |  1                    |  6.8769e-06           |  7.6227e-07           |
|  [Callback]train_callback.on_train_start                              |  6.6869e-06           |  1                    |  6.6869e-06           |  7.4121e-07           |
|  [LightningModule]RWKV_shared.configure_callbacks                     |  6.4597e-06           |  1                    |  6.4597e-06           |  7.1602e-07           |
|  [LightningModule]RWKV_shared.configure_sharded_model                 |  4.9025e-06           |  1                    |  4.9025e-06           |  5.4342e-07           |
|  [LightningModule]RWKV_shared.on_fit_start                            |  4.6622e-06           |  1                    |  4.6622e-06           |  5.1678e-07           |
|  [LightningModule]RWKV_shared.setup                                   |  4.3046e-06           |  1                    |  4.3046e-06           |  4.7714e-07           |
|  [Callback]ModelSummary.on_train_epoch_start                          |  4.1723e-06           |  1                    |  4.1723e-06           |  4.6248e-07           |
|  [Callback]GradientAccumulationScheduler.setup                        |  3.5577e-06           |  1                    |  3.5577e-06           |  3.9435e-07           |
|  [Callback]ModelSummary.on_train_start                                |  3.5428e-06           |  1                    |  3.5428e-06           |  3.927e-07            |
|  [LightningModule]RWKV_shared.prepare_data                            |  3.2429e-06           |  1                    |  3.2429e-06           |  3.5946e-07           |
|  [Callback]train_callback.teardown                                    |  3.1851e-06           |  1                    |  3.1851e-06           |  3.5306e-07           |
|  [Callback]ModelSummary.setup                                         |  3.1143e-06           |  1                    |  3.1143e-06           |  3.4521e-07           |
|  [Callback]GradientAccumulationScheduler.on_train_epoch_start         |  2.9895e-06           |  1                    |  2.9895e-06           |  3.3138e-07           |
|  [Callback]GradientAccumulationScheduler.on_fit_start                 |  2.7642e-06           |  1                    |  2.7642e-06           |  3.0639e-07           |
|  [LightningModule]RWKV_shared.on_fit_end                              |  2.4512e-06           |  1                    |  2.4512e-06           |  2.7171e-07           |
|  [LightningModule]RWKV_shared.teardown                                |  2.4121e-06           |  1                    |  2.4121e-06           |  2.6737e-07           |
|  [LightningModule]RWKV_shared.on_train_start                          |  2.1905e-06           |  1                    |  2.1905e-06           |  2.428e-07            |
|  [LightningModule]RWKV_shared.on_train_epoch_end                      |  1.8496e-06           |  1                    |  1.8496e-06           |  2.0502e-07           |
|  [Callback]ModelSummary.on_train_end                                  |  1.7323e-06           |  1                    |  1.7323e-06           |  1.9201e-07           |
|  [Callback]TQDMProgressBar.on_fit_end                                 |  1.6745e-06           |  1                    |  1.6745e-06           |  1.8561e-07           |
|  [Callback]ModelSummary.teardown                                      |  1.6149e-06           |  1                    |  1.6149e-06           |  1.7901e-07           |
|  [Strategy]DeepSpeedStrategy.on_train_end                             |  1.5628e-06           |  1                    |  1.5628e-06           |  1.7322e-07           |
|  [Callback]TQDMProgressBar.on_fit_start                               |  1.5572e-06           |  1                    |  1.5572e-06           |  1.726e-07            |
|  [LightningModule]RWKV_shared.on_train_end                            |  1.5255e-06           |  1                    |  1.5255e-06           |  1.6909e-07           |
|  [Callback]GradientAccumulationScheduler.teardown                     |  1.4156e-06           |  1                    |  1.4156e-06           |  1.5691e-07           |
|  [Callback]TQDMProgressBar.teardown                                   |  1.4119e-06           |  1                    |  1.4119e-06           |  1.565e-07            |
|  [LightningModule]RWKV_shared.on_train_epoch_start                    |  1.3672e-06           |  1                    |  1.3672e-06           |  1.5155e-07           |
|  [Strategy]DeepSpeedStrategy.on_train_start                           |  1.2964e-06           |  1                    |  1.2964e-06           |  1.437e-07            |
|  [Callback]GradientAccumulationScheduler.on_train_end                 |  1.2591e-06           |  1                    |  1.2591e-06           |  1.3957e-07           |
|  [Callback]ModelSummary.on_fit_end                                    |  1.2591e-06           |  1                    |  1.2591e-06           |  1.3957e-07           |
|  [Callback]GradientAccumulationScheduler.on_train_epoch_end           |  1.1958e-06           |  1                    |  1.1958e-06           |  1.3255e-07           |
|  [Callback]GradientAccumulationScheduler.on_fit_end                   |  1.0263e-06           |  1                    |  1.0263e-06           |  1.1376e-07           |
|  [Callback]GradientAccumulationScheduler.on_train_start               |  9.723e-07            |  1                    |  9.723e-07            |  1.0777e-07           |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------